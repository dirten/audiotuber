#!/usr/bin/env perl

use strict;
use warnings;

use Getopt::Long;
use App::PhotoDB;

# Read in our command line options
my %params = ();
GetOptions ( \%params,
	"mp3|m=s",      # MP3 file
	"image|i=s",    # image file
	"title|t=s",    # track title
	"artist|a=s",   # artist
	"composer|c=s", # composer
	"ffmpeg|f=s",   # path to ffmpeg
) or die("Error in command line arguments\n");

my $ffmpeg = $params{ffmpeg} // 'ffmpeg';
if (!-x $ffmpeg) {
	print "Could not find ffmpeg executable\n";
	die;
}

if (!$params{mp3}) {
	print "Must provide an MP3 file\n";
	die;
}

if (!-e $params{mp3}) {
	print "MP3 file $params{mp3} does not exist\n";
	die;
}

if ($params{mp3} !~ m/\.mp3$/i) {
	print "MP3 file $params{mp3} is not a valid MP3 file\n";
	die;
}
